import json


idx = {
    0: 0,
    1: 1,
    2: 3,
    3: 5,
    4: 6,
    5: 8,
    6: 10,
    7: 12
}


base = 18
loveu = "1,0.25  1,0.25  \
    1,0.25  1,0.25  1,0.25  1,0.25  1,0.5  1,0.25  6_,0.75  1,0.5  0,0.75  1,0.25 \
    5_,0.25  5_,0.25  5_,0.25  5_,0.25  2,0.5  7_,0.25  1,0.75  5_,0.5  0,0.5  5_,0.25  1,0.25 \
    1,0.25  1,0.5  1,0.25  3,0.5  1,0.25  1,0.75  6_,0.5  0,0.5  6_,0.5 \
    5_,0.25  5_,0.25  5_,0.25  5_,0.25  2,0.5  7_,0.25  1,1.25  3_,0.5  4_,0.5 \
    5_,1  1,1  7_,0.5  7_,0.5  6_,0.5  6_,0.25  6_,0.75  \
    5_,0.5  2_,0.5  4_,0.25  4_,0.75  3_,0.5  0,0.5  1_,1  \
    1_,0.5  6_,0.5  7_,0.25  6_,0.75  5_,0.5  0,0.5  3_,0.5  \
    4_,0.5  5_,0.5  6_,0.5  7_,0.25  6_,0.75  5_,0.5  0,1  \
    5_,1  1,0.5  1,0.25  1,0.75  6_,0.5  0,0.5  6_,0.5  \
    5_,0.5  2,0.5  2,0.5  7_,0.25  1,0.75  3,0.5  0,0.5  4,1  \
    4,0.5  3,0.5  3,0.5  1,0.5  6_,0.5  7_,0.5  1,0.25  2,2.25 \
    1,0.5  1,0.5  2,0.5  3,0.5  3,0.5  5,0.5  5,0.25  5,0.75  4,0.5  0,0.5 \
    1,0.5  2,0.5  2,0.5  4,0.5  5,0.25  4,0.75  3,0.5  0,1  \
    1,0.5  1,0.5  3,0.5  4,0.25  3,0.75  2,0.5  6_,0.5  7_,0.5 \
    1,1  3,0.5  4,0.25  3,0.75  2,0.5  0,0.5  5_,0.5  \
    3,1.25  5,0.25  5,0.25   5,0.5   4,0.5  0,0.5  1,0.5  \
    2,0.5  2,0.5  4,0.5  5,0.25  4,0.75  3,0.5  0,0.5  1,0.5  \
    1,0.5  6,0.5  0,0.5  1,0.5  7_,0.5  3,0.5  3,0.25  3,0.75  \
    1,0.5  0,0.5  2,0.25  1,0.75  "

dandelion_main = " \
    0,0.5  3,0.5  4,0.5  5,1  \
    5,0.5  5,0.5  5,0.5  0,0.5  6,0.5  7,0.5  1+,2.5  \
    1+,0.5  7,0.5  2+,0.5  6,1  \
    5,0.5  5,0.5  2+,1  1+,0.5  3+,0.5  3+,2.5  \
    1+,0.5  2+,0.5   3+,0.5  3+,1  \
    3+,0.5  4+,0.5  3+,1  2+,0.5  3+,0.5  1+,1.5  \
    0,1  6,0.5  7,0.5  1+,0.5  2+,1  \
    1+,0.5  1+,0.5  6,1  3+,0.5  3+,0.5  2+,2.5 \
    0,0.5  \
    3,0.5  4,0.5  5,1  \
    5,0.5  5,0.5  5,0.5  6,0.5  7,0.5  5,0.25  1+,2.25  \
    1+,0.5  7,0.5  2+,0.5  6,1  \
    5,0.5  5,0.5  2+,1  1+,0.5  3+,0.5  3+,2.5  \
    1+,0.5  2+,0.5   3+,0.5  3+,1  \
    3+,0.5  4+,0.5  3+,1  2+,0.5  3+,0.5  1+,1.5  \
    0,1  6,0.5  7,0.5  1+,0.5  2+,1  \
    1+,0.5  1+,0.5  6,1  3+,0.5  3+,0.5  2+,2.5 \
    0,0.5 \
    3,0.5  5,0.5   1+,0.5  3+,0.5 \
    3+,1.5  4+,0.5  2+,2  \
    2+,1  5+,0.5  7,0.5  1+,2  \
    3+,0.5  4+,0.5  5+,0.5  1+,0.5  1+,1  2+,0.75  3+,2.25 \
    3,0.5  5,0.5  1+,0.75  3+,0.25  \
    3+,1.5  4+,0.5  2+,2  \
    2+,1  5+,0.5  7,0.5  1+,2  \
    3+,0.5  4+,0.5  5+,0.5  1+,0.5  1+,1  2+,1 \
    1+,4 \
    0,28 \
    0,2.5 \
    3,0.5  4,0.5  5,1 \
    5,0.5  5,0.5  5,0.5  0,0.5  6,0.5  7,0.5  1+,2.5  \
    1+,0.5  7,0.5  2+,0.5  6,1  \
    5,0.5  5,0.5  2+,1  1+,0.5  3+,0.5  3+,2.5  \
    1+,0.5  2+,0.5   3+,0.5  3+,1  \
    3+,0.5  4+,0.5  3+,1  2+,0.5  3+,0.5  1+,1.5  \
    0,1  6,0.5  7,0.5  1+,0.5  2+,1  \
    1+,0.5  1+,0.5  6,1  3+,0.5  3+,0.5  2+,2.5 \
    0,0.5  \
    3,0.5  4,0.5  5,1  \
    5,0.5  5,0.5  5,0.5  6,0.5  7,0.5  5,0.25  1+,2.25  \
    1+,0.5  7,0.5  2+,0.5  6,1  \
    5,0.5  5,0.5  2+,1  1+,0.5  3+,0.5  3+,2.5  \
    1+,0.5  2+,0.5   3+,0.5  3+,1  \
    3+,0.5  4+,0.5  3+,1  2+,0.5  3+,0.5  1+,1.5  \
    0,1  6,0.5  7,0.5  1+,0.5  2+,1  \
    1+,0.5  1+,0.5  6,1  3+,0.5  3+,0.5  2+,2.5 \
    0,0.5 \
    3,0.5  5,0.5   1+,0.5  3+,0.5 \
    3+,1.5  4+,0.5  2+,2  \
    2+,1  5+,0.5  7,0.5  1+,2  \
    3+,0.5  4+,0.5  5+,0.5  1+,0.5  1+,1  2+,0.75  3+,2.25 \
    3,0.5  5,0.5  1+,0.75  3+,0.25  \
    3+,1.5  4+,0.5  2+,2  \
    2+,1  5+,0.5  7,0.5  1+,2  \
    3+,0.5  4+,0.5  5+,0.5  1+,0.5  1+,1  2+,1  \
    1+,2  6+,0.5  5+,0.5  3+,0.5  2+,0.5  \
    3+,1.5  4+,0.5  2+,2  \
    6+,1  5+,0.5  7,0.5  1+,2  \
    3+,0.5  4+,0.5  5+,0.5  1+,0.5  1+,1  2+,0.5  3+,0.5  \
    3+,2  3,0.5  5,0.5  1+,0.75  3+,0.25  \
    3+,1.5  2+,0.5  2+,2  \
    2+,1  5+,0.5  7,0.5  1+,2  \
    3+,0.5  4+,0.5  5+,0.5  1+,0.5  1+,1  2+,1  \
    1+,4"

dandelion_accomp1 = "0,2  1_,0.5  5_,0.5  3,1  7__,0.5  5_,0.5  2,1  \
    6__,0.5  3_,0.5  1,1  3_,1  7_,1  \
    4__,0.5  1_,0.5  6_,1  5__,0.5  2_,0.5  7_,1 \
    5_,1  3_,1  6_,1  1,1  \
    3_,1  2,1  3,1  5,1  \
    6__,0.5  3_,0.5  5_,0.5  3_,0.5  4__,0.5  3_,0.5  6_,0.5  3_,0.5 \
    4__,0.5  1_,0.5  6_,1  2__,0.5  6__,0.5  4_,1 \
    5__,0.5  2_,0.5  5_,1                   \
    5__,1   5__,0.5  1_,0.5  5_,0.5  2,0.5  3,0.5  7__,0.5  5_,0.5  7_,0.5  2,0.5  \
    6__,0.5  3_,0.5  1,1  3_,1  7_,1  \
    4__,0.5  1_,0.5  6_,1  5__,1  2_,0.5  7_,1 \
    5_,1  3_,1  6_,1  1,1  \
    3_,1  2,1  3,1  5,1  \
    6__,0.5  3_,0.5  5_,0.5  3_,0.5  4__,0.5  3_,0.5  6_,0.5  3_,0.5 \
    4__,0.5  1_,0.5  6_,1  2__,0.5  6__,0.5  4_,1 \
    5__,0.5  2_,0.5  5_,1 \
    4_,1  5__,1  \
    4__,0.5  1_,0.5  4_,0.5  1_,0.5  4__,0.5  2_,0.5  7_,0.5  2_,0.5  \
    3__,0.5  7__,0.5  5_,0.5  7__,0.5  6__,0.5  3_,0.5  1,0.5  3_,0.5  \
    4__,0.5  1_,0.5  6_,0.5  4__,0.5  4_,0.5  2_,0.5  5_,0.5  5__,0.5 \
    1__,0.5  5_,0.5  2,0.5  5_,0.5  1__,1  1__,1  \
    4__,0.5  1_,0.5  4_,0.5  1_,0.5  4__,0.5  2_,0.5  7_,0.5  2_,0.5  \
    3__,0.5  7__,0.5  5_,0.5  7__,0.5  6__,0.5  3_,0.5  1,0.5  3_,0.5 \
    4__,0.5  1_,0.5  6_,0.5  4__,0.5  4_,0.5  2_,0.5  5_,1 \
    2+,0.25  2,0.25  5,0.25  2+,0.25  1+,0.5  3,0.25  1+,0.25  7,0.25  2,0.25  3,0.25  7,0.25  1+,0.25  2,0.25  3,0.25  1+,0.25  \
    2+,0.25  2,0.25  5,0.25  2+,0.25  1+,0.25  3,0.25  5,0.25  1+,0.25  7,0.25  2,0.25  3,0.25  7,0.25  1+,0.25  2,0.25  3,0.25  1+,0.25 \
    3+,0.25  4,0.25  6,0.25  3+,0.25  2+,0.25  4,0.25  6,0.25  2+,0.25  1+,0.25  4,0.25  6,0.25  1+,0.25  2+,0.25  4,0.25  6,0.25  2+,0.25  \
    3+,0.25  4,0.25  6,0.25  3+,0.25  2+,0.25  4,0.25  6,0.25  2+,0.25  4+,0.25  4,0.25  5,0.25  4+,0.25  3+,0.25  4,0.25  5,0.25  3+,0.25  \
    2+,0.25  2,0.25  5,0.25  2+,0.25  1+,0.5  3,0.25  1+,0.25  7,0.25  2,0.25  3,0.25  7,0.25  1+,0.25  2,0.25  3,0.25  1+,0.25  \
    2+,0.25  2,0.25  5,0.25  2+,0.25  1+,0.25  3,0.25  5,0.25  1+,0.25  7,0.25  2,0.25  3,0.25  7,0.25  1+,0.25  2,0.25  3,0.25  1+,0.25 \
    3+,0.25  4,0.25  6,0.25  3+,0.25  2+,0.25  4,0.25  6,0.25  2+,0.25  1+,0.25  4,0.25  6,0.25  1+,0.25  2+,0.25  4,0.25  6,0.25  2+,0.25  \
    3+,0.25  4,0.25  6,0.25  3+,0.25  2+,0.25  4,0.25  6,0.25  2+,0.25  4+,0.25  4,0.25  5,0.25  4+,0.25  3+,0.25  4,0.25  5,0.25  3+,0.25  \
    1+,2.5 \
    0,1.5  1_,0.5  5_,0.5  3,1  7__,0.5  5_,0.5  2,1  \
    6__,0.5  3_,0.5  1,1  3_,1  7_,1  \
    4__,0.5  1_,0.5  6_,1  5__,0.5  2_,0.5  7_,1 \
    5_,1  3_,1  6_,1  1,1  \
    3_,1  2,1  3,1  5,1  \
    6__,0.5  3_,0.5  5_,0.5  3_,0.5  4__,0.5  3_,0.5  6_,0.5  3_,0.5 \
    4__,0.5  1_,0.5  6_,1  2__,0.5  6__,0.5  4_,1 \
    5__,0.5  2_,0.5  5_,1                   \
    5__,1   5__,0.5  1_,0.5  5_,0.5  2,0.5  3,0.5  7__,0.5  5_,0.5  7_,0.5  2,0.5  \
    6__,0.5  3_,0.5  1,1  3_,1  7_,1  \
    4__,0.5  1_,0.5  6_,1  5__,1  2_,0.5  7_,1 \
    5_,1  3_,1  6_,1  1,1  \
    3_,1  2,1  3,1  5,1  \
    6__,0.5  3_,0.5  5_,0.5  3_,0.5  4__,0.5  3_,0.5  6_,0.5  3_,0.5 \
    4__,0.5  1_,0.5  6_,1  2__,0.5  6__,0.5  4_,1 \
    5__,0.5  2_,0.5  5_,1 \
    4_,1  5__,1  \
    4__,0.5  1_,0.5  4_,0.5  1_,0.5  4__,0.5  2_,0.5  7_,0.5  2_,0.5  \
    3__,0.5  7__,0.5  5_,0.5  7__,0.5  6__,0.5  3_,0.5  1,0.5  3_,0.5  \
    4__,0.5  1_,0.5  6_,0.5  4__,0.5  4_,0.5  2_,0.5  5_,0.5  5__,0.5 \
    1__,0.5  5_,0.5  2,0.5  5_,0.5  1__,1  1__,1  \
    4__,0.5  1_,0.5  4_,0.5  1_,0.5  4__,0.5  2_,0.5  7_,0.5  2_,0.5  \
    3__,0.5  7__,0.5  5_,0.5  7__,0.5  6__,0.5  3_,0.5  1,0.5  3_,0.5 \
    4__,0.5  1_,0.5  6_,0.5  4__,0.5  4_,0.5  2_,0.5  5_,1  \
    1_,1  1_,0.5  1_,0.5  6__,1  1__,0.5  1_,0.25  1__,0.25  \
    4__,0.5  1_,0.5  4_,0.5  1_,0.5  4__,0.5  2_,0.5  7_,0.5  2_,0.5 \
    3__,0.5  7__,0.5  5_,0.5  7__,0.5  6__,0.5  3_,0.5  1,0.5  3_,0.5  \
    4__,0.5  1_,0.5  6_,0.5  4__,0.5  4_,0.5  2_,0.5  5_,0.5  5__,0.5  \
    1__,0.5  5_,0.5  2,0.5  5_,0.5  1__,1  1__,1   \
    4__,0.5  1_,0.5  4_,0.5  1_,0.5  4__,0.5  2_,0.5  7_,0.5  2_,0.5 \
    3__,0.5  7__,0.5  5_,0.5  7__,0.5  6__,0.5  3_,0.5  1,0.5  3_,0.5  \
    4__,0.5  1_,0.5  6_,0.5  4__,0.5  4_,0.5  2_,0.5  5_,1 \
    1_,0.5, 5_,0.5  2,0.5  5_,0.5  1__,2"

dandelion_accomp2 = " 0,94 \
    2+,1  1+,1  7,1  1+,1   \
    2+,1  1+,1  7,1  1+,1   \
    3+,1  2+,1  1+,1  2+,1  \
    3+,1  2+,1  4+,1  3+,1  \
    2+,1  1+,1  7,1  1+,1   \
    2+,1  1+,1  7,1  1+,1   \
    3+,1  2+,1  1+,1  2+,1  \
    3+,1  2+,1  4+,1  3+,1  \
    1+,2.5  0,93.5 \
    0,36"

melody = loveu
jsonfile = "loveu.json"
melody_li = melody.split()
song = []

# base = [55, 110, 220, 440, 880]
total_beat = 0
for mel in melody_li:
    tune_beat = mel.split(',')
    beat = float(tune_beat[1])
    total_beat += beat
    t = idx[int(tune_beat[0][0])]
    if t != 0:
        idx_0 = (t + base + 11) % 12 + 1
        if len(tune_beat[0]) == 1:
            idx_1 = 3
        elif len(tune_beat[0]) == 2:
            if tune_beat[0][1] == '+':
                idx_1 = 4
            elif tune_beat[0][1] == '_':
                idx_1 = 2
            else: 
                idx_1 = 3
        else:
            if tune_beat[0][1] == '_' and tune_beat[0][2] == '_':
                idx_1 = 1
            elif tune_beat[0][1] == '+' and tune_beat[0][2] == '+':
                idx_1 = 5
            else:
                idx_1 = 3
        idx_1 += (t + base - 1) // 12
    else:
        idx_0 = 0
        idx_1 = 0
    song.append([idx_1, idx_0, beat])

json_song = {'song': song}
with open(jsonfile, "w") as f:
    _ = json.dump(json_song, f)
print(total_beat, len(melody_li))